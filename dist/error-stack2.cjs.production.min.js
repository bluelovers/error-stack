"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("crlf-normalize");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=t(require("string-split-keep"));function n(e){return e.trim()}const a=/^([a-z][a-z0-9_]*):\s+([\s\S]+)$/i,l=/^at\s+/,s=/^eval\s+at\s+/;function o(e,t,r){if(!e.endsWith(r))return[e];let a,l=e.length-1,s=1;for(;--l>=0;){const n=e.charAt(l);if(n===r)s++;else if(n===t&&0==--s){a=l;break}}return[e.slice(0,a),e.slice(a+1,-1)].map(n)}function c(e){const[t,n,a]=r.default(e,":",-3);return null!=a&&a.length&&null!=n&&n.length?{source:t,line:n,col:a}:{source:e}}function i(e){const[t,r]=e.replace(s,"").split(/,\s+/g).map(n),{eval:a,callee:l,calleeNote:o,...i}=u(t);return{evalCallee:l,evalCalleeNote:o,...i,evalTrace:c(r)}}function u(e,t){const r=e.replace(l,"");let[n,a]=o(r,"(",")");a||([n,a]=[a,n]);const u={};if(n){const[e,t]=o(n,"[","]");u.callee=e,u.calleeNote=t}else u.callee=n;return"eval"===u.callee&&(u.eval=!0),Object.assign(u,t&&s.test(a)?i(a):c(a)),u}function p(e){return e.eval||"number"==typeof e.line||"string"==typeof e.line&&/^\d+$/.test(e.line)}function f(t){const[r,...l]=e.lineSplit(t),s=l.findIndex((e=>e.trimLeft().startsWith("at")&&p(u(n(e),!0)))),o=[r,...l.splice(0,s)],[,c,i]=o.join("\n").match(a);return{type:c,message:i,traces:l.map((e=>u(n(e),!0)))}}function v({callee:e,calleeNote:t,source:r,line:n,col:a}){const l=[r,n,a].filter(Boolean).join(":");return e?`${e}${t?` [${t}]`:""} (${l})`:l}function m({callee:e,evalTrace:t,evalCallee:r,evalCalleeNote:n,...a}){return`${e} (eval at ${v({...a,callee:null!=r?r:"<anonymous>",calleeNote:n})}, ${v(t)})`}function d({type:e,message:t}){return`${e}: ${t}`}function g(e){return`    at ${e.eval?m(e):v(e)}`}class h{constructor(e){if("string"!=typeof e)throw new TypeError("stack must be a string");Object.assign(this,f(e))}filter(e){return this.traces=this.traces.filter(e),this}format(){const{type:e,message:t}=this,r=`${d({type:e,message:t})}`,n=this.traces.map(g).join("\n");return n?r+"\n"+n:r}}function x(e){return new h(e)}exports.ErrorStack=h,exports.breakBrackets=o,exports.default=x,exports.formatEvalTrace=m,exports.formatLineTrace=g,exports.formatMessage=d,exports.formatTrace=v,exports.parseErrorStack=x,exports.parseEvalSource=i,exports.parseSource=c,exports.parseStack=f,exports.parseTrace=u,exports.validPosition=function(e){var t,r;return(null===(t=e.line)||void 0===t?void 0:t.toString().match(/^\d+$/))&&(null===(r=e.col)||void 0===r?void 0:r.toString().match(/^\d+$/))},exports.validTrace=p;
//# sourceMappingURL=error-stack2.cjs.production.min.js.map
