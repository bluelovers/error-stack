"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("crlf-normalize");const t=/^([a-z][a-z0-9_]*):\s+([\s\S]+)$/i,r=/^at\s+/,s=/^eval\s+at\s+/;function a(e){return e.trim()}function n(e,t,r){if(!e.endsWith(r))return[e];let s,n=e.length-1,c=1;for(;--n>=0;){const a=e.charAt(n);if(a===r)c++;else if(a===t&&0==--c){s=n;break}}return[e.slice(0,s),e.slice(s+1,-1)].map(a)}function c(e){const[t,r,s]=e.split(":");return{source:t,line:r,col:s}}function o(e){const[t,r]=e.replace(s,"").split(/,\s+/g).map(a),{source:n,line:o,col:i}=l(t);return{source:n,line:o,col:i,evalTrace:c(r)}}function l(e,t){const a=e.replace(r,"");let[l,i]=n(a,"(",")");i||([l,i]=[i,l]);const u={};if(l){const[e,t]=n(l,"[","]");u.callee=e,u.calleeNote=t}else u.callee=l;return"eval"===u.callee&&(u.eval=!0),Object.assign(u,t&&s.test(i)?o(i):c(i)),u}function i(e){return e.line||e.eval}function u(r){const[s,...n]=e.lineSplit(r),c=n.findIndex((e=>e.trimLeft().startsWith("at")&&i(l(a(e),!0)))),o=[s,...n.splice(0,c)],[,u,p]=o.join("\n").match(t);return{type:u,message:p,traces:n.map((e=>l(a(e),!0)))}}function p({callee:e,calleeNote:t,source:r,line:s,col:a}){const n=[r,s,a].filter(Boolean).join(":");return e?`${e}${t?` [${t}]`:""} (${n})`:n}function f({callee:e,evalTrace:t,...r}){return`${e} (eval at ${p({...r,callee:"<anonymous>"})}, ${p(t)})`}function m({type:e,message:t}){return`${e}: ${t}`}class x{constructor(e){if("string"!=typeof e)throw new TypeError("stack must be a string");Object.assign(this,u(e))}filter(e){return this.traces=this.traces.filter(e),this}format(){const{type:e,message:t}=this,r=`${m({type:e,message:t})}`,s=this.traces.map((e=>`    at ${e.eval?f(e):p(e)}`)).join("\n");return s?r+"\n"+s:r}}function v(e){return new x(e)}exports.ErrorStack=x,exports.breakBrackets=n,exports.default=v,exports.formatEvalTrace=f,exports.formatMessage=m,exports.formatTrace=p,exports.parse=u,exports.parseErrorStack=v,exports.parseEvalSource=o,exports.parseSource=c,exports.parseTrace=l,exports.validTrace=i;
//# sourceMappingURL=error-stack2.cjs.production.min.js.map
